{"version":3,"sources":["BigNativeAd.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../../assets/Script/ad","sourcesContent":["/**\n * @desc: 640 x 320 原生广告\n * @Create Date: 2019-08-29 16:22:12\n * @Last Modified time: 2019-08-29 16:22:12\n */\nconst { ccclass, property } = cc._decorator\n\ninterface INativeAd {\n  load: Function\n  destroy: Function\n  onLoad: Function\n  onError: Function\n  reportAdClick: Function\n  reportAdShow: Function\n  offLoad: Function\n  offError: Function\n}\n\ninterface IAdData {\n  logoUrl: string\n  imgUrlList: Array<string>\n  adId: string | number\n  clickBtnTxt: string\n  title: string\n  desc: string\n}\n\n@ccclass\nexport default class BigNativeAd extends cc.Component {\n  @property(cc.Button)\n  returnBtn: cc.Button = null\n\n  @property(cc.Node)\n  showBtn: cc.Node = null\n\n  @property(cc.Node)\n  loadBtn: cc.Node = null\n\n  @property(cc.Node)\n  destroyBtn: cc.Node = null\n\n  @property(cc.Node)\n  logLabel: cc.Node = null\n\n  @property(cc.Object)\n  nativeAd: INativeAd = null\n\n  @property(cc.Node)\n  adLayout: cc.Node = null\n\n  @property(cc.Object)\n  adData: IAdData = null\n\n  start() {\n    this.adLayout.active = false\n    this.nativeAd = qg.createNativeAd({\n      // https://u.oppomobile.com/main/app.html 广告联盟网站中媒体管理 > 广告管理中广告名称下面的 id 即为 adUnitId\n      adUnitId: '199390'\n    })\n    // 以下所有小游戏 API 需支持最低小游戏平台版本号'1031' (minPlatformVersion>='1031')\n    this.loadBtn.on(cc.Node.EventType.TOUCH_START, () => {\n      this.log('加载原生广告')\n      this.adData = null\n      // 手动拉取广告，成功回调 onLoad，失败回调 onError\n      this.nativeAd\n        .load()\n        .then(() => {\n          console.log('promise 回调：加载成功')\n        })\n        .catch(err => {\n          console.log(`promise 回调：加载失败 ${JSON.stringify(err)}`)\n        })\n    })\n\n    this.showBtn.on(cc.Node.EventType.TOUCH_START, () => {\n      this.log('展示原生广告')\n      // 调用 load 方法请求展示 banner，成功的时候回调 onShow，出错的时候回调 onError\n      this.showAd()\n    })\n    this.destroyBtn.on(cc.Node.EventType.TOUCH_START, () => {\n      this.log('销毁原生广告')\n      // 销毁组件，释放资源\n      this.nativeAd.destroy()\n      // 销毁广告组件之后无法再加载、展示广告。得重新新建\n      this.showBtn.active = false\n      this.loadBtn.active = false\n    })\n    // 设置原生广告加载成功回调\n    this.nativeAd.onLoad(res => {\n      this.log(`加载原生广告成功`, `：${JSON.stringify(res)}`)\n      res.adList && res.adList.length > 0 && (this.adData = res.adList[0])\n    })\n    // 设置原生广告出错回调\n    this.nativeAd.onError(err => {\n      this.log(`设置原生广告出错：${JSON.stringify(err)}`)\n    })\n  }\n\n  // 回调信息展示\n  log(msg, detail = '') {\n    console.log(msg + detail)\n    this.logLabel.getComponent(cc.Label).string = msg\n  }\n\n  showAd() {\n    if (!this.adData) return\n    this.adLayout.active = true\n    let adImg = void 0,\n      adDesc = void 0,\n      adLogo = void 0,\n      adClose = void 0,\n      adTitle = void 0,\n      adAction = void 0\n    let containLayout = this.adLayout.getChildByName('containLayout')\n    adImg = containLayout.getChildByName('adImg')\n    adDesc = containLayout.getChildByName('adDesc')\n    adLogo = containLayout.getChildByName('adLogo')\n    adClose = containLayout.getChildByName('adClose')\n    let actionLayout = this.adLayout.getChildByName('actionLayout')\n    adAction = actionLayout.getChildByName('adAction')\n    adTitle = actionLayout.getChildByName('adTitle')\n\n    // 加载广告图片\n    adImg.active = false\n    this.adData.imgUrlList &&\n      this.adData.imgUrlList.length > 0 &&\n      cc.loader.load(this.adData.imgUrlList[0], (err, texture) => {\n        adImg.active = true\n        adImg.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(texture)\n      })\n\n    // 加载广告 logo\n    adLogo.active = false\n    this.adData.logoUrl &&\n      cc.loader.load(this.adData.logoUrl, function(err, texture) {\n        adLogo.active = true\n        adLogo.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(texture)\n      })\n    adTitle.getComponent(cc.Label).string = this.adData.title\n    adDesc.getComponent(cc.Label).string = this.adData.desc\n    adAction\n      .getChildByName('Background')\n      .getChildByName('clickBtnTxt')\n      .getComponent(cc.Label).string = this.adData.clickBtnTxt\n    adClose.on(cc.Node.EventType.TOUCH_START, () => {\n      this.adLayout.active = false\n    })\n    adAction.on(cc.Node.EventType.TOUCH_START, () => {\n      // 点击广告按钮下载\n      this.nativeAd.reportAdClick({\n        adId: this.adData.adId\n      })\n    })\n    this.nativeAd.reportAdShow({\n      adId: this.adData.adId\n    })\n  }\n\n  // 返回\n  onClickReturnBtn() {\n    cc.director.loadScene('nativeAd')\n  }\n\n  onDestroy() {\n    if (!this.nativeAd) return\n    this.nativeAd.offLoad() // 移除原生广告加载成功回调\n    this.nativeAd.offError() // 移除失败回调\n    this.nativeAd.destroy() // 隐藏 banner，成功回调 onHide, 出错的时候回调 onError\n    console.log('640 x 320 原生广告销毁')\n  }\n}\n"]}