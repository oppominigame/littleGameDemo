{"version":3,"sources":["../../../../../assets/Script/platform/assets/Script/platform/Platform.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../../assets/Script/platform","sourcesContent":["/**\n * @desc: 平台能力\n * @Create Date: 2019-08-28 17:54:21\n * @Last Modified time: 2019-08-29 15:24:06\n */\nconst { ccclass, property } = cc._decorator\n\n@ccclass\nexport default class Platform extends cc.Component {\n  @property(cc.Label)\n  logLabel: cc.Label = null\n\n  @property(cc.Node)\n  loginBtn: cc.Node = null\n\n  @property(cc.Node)\n  homescreenIconBtn: cc.Node = null\n\n  @property(cc.Node)\n  jumpBtn: cc.Node = null\n\n  @property(cc.Node)\n  returnBtn: cc.Node = null\n\n  start() {\n    // 登录，支持最低平台版本号'1040' (minPlatformVersion>='1040')\n    this.loginBtn.on(cc.Node.EventType.TOUCH_START, () => {\n      qg.login({\n        success: res => {\n          // 可全局储存 token，方便其他能力获取，注意 token 过期时间\n          this.log(`登录成功: ${JSON.stringify(res.data)}`)\n          window['TOKEN'] = res.data.token\n        },\n        fail: res => {\n          this.log(`登录失败: ${JSON.stringify(res)}`)\n        }\n      })\n    })\n    // 创建桌面图标，支持最低平台版本号 1040\n    this.homescreenIconBtn.on(cc.Node.EventType.TOUCH_START, () => {\n      // 判断是否已经创建桌面图标\n      qg.hasShortcutInstalled({\n        success: res => {\n          // 判断图标未存在时，创建图标\n          if (res == false) {\n            // 创建桌面图标，需要用户授权\n            qg.installShortcut({\n              success: res => {\n                // 可执行用户创建图标奖励\n                this.log(`调起创建桌面图标弹窗成功: ${JSON.stringify(res)}，\n                注：由于安卓系统高低版本能力的差异，为了体验统一暂时不提供用户点击取消、添加按钮的回调，可以自己设置时间间隔结合检测创建桌面图标与否的接口做判断`)\n              },\n              fail: err => {\n                this.log(`调起创建桌面图标弹窗失败: ${JSON.stringify(err)}`)\n              },\n              complete: () => {\n                console.log('调起创建桌面图标弹窗')\n              }\n            })\n          } else {\n            this.log('桌面图标已创建')\n          }\n        },\n        fail: err => {\n          this.log(JSON.stringify(err))\n        }\n      })\n    })\n\n    this.jumpBtn.on(cc.Node.EventType.TOUCH_START, () => {\n      this.log(`平台版本号： ${window['Global'] && window['Global'].platformVersion}`)\n\n      // 跳转小游戏按钮，支持最低平台版本号'1044' (minPlatformVersion>='1044')\n      if (window['Global'] && window['Global'].platformVersion >= 1044) {\n        qg.navigateToMiniGame({\n          pkgName: 'com.wepie.snake.miniprogram.nearme.gamecenter', // 要打开的小游戏包名, 此 demo 是贪吃蛇的包名\n          success: () => {\n            this.log('跳转小游戏成功')\n          },\n          fail: res => {\n            this.log(`跳转小游戏失败：${JSON.stringify(res)}`)\n          }\n        })\n      } else {\n        this.log('平台版本号小于1044，不支持跳转小游戏')\n      }\n    })\n\n    this.returnBtn.on(cc.Node.EventType.TOUCH_START, () => {\n      cc.director.loadScene('main')\n    })\n  }\n\n  // 回调信息展示\n  log(msg) {\n    console.log(msg)\n    this.logLabel.getComponent(cc.Label).string = msg\n  }\n}\n"]}