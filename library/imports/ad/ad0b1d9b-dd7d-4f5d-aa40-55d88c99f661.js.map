{"version":3,"sources":["../../../../../assets/Script/voice/assets/Script/voice/Voice.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../../assets/Script/voice","sourcesContent":["/**\n * @desc: { 多人实时语音 } \n * @author: zhengyiqiu \n * @Create Date: 2020-06-23 10:21:00 \n * @Last Modified by: zhengyiqiu\n * @Last Modified time: 2021-09-24 10:20:55\n */\n\nconst { ccclass, property } = cc._decorator\n\n@ccclass\nexport default class Voice extends cc.Component {\n  @property(cc.EditBox)\n  ipInput: cc.EditBox = null\n\n  @property(cc.EditBox)\n  groupIdInput: cc.EditBox = null\n\n  @property(cc.Toggle)\n  microphoneToggle: cc.Toggle = null\n\n  @property(cc.Toggle)\n  speakerphoneToggle: cc.Toggle = null\n\n  @property(cc.Toggle)\n  playBGMToggle: cc.Toggle = null\n\n  @property(cc.Node)\n  joinBtn: cc.Node = null\n\n  @property(cc.Node)\n  exitBtn: cc.Node = null\n\n  @property(cc.Node)\n  updateBtn: cc.Node = null\n\n  @property(cc.Node)\n  onStatusBtn: cc.Node = null\n\n  @property(cc.Node)\n  onMembersChangeBtn: cc.Node = null\n\n  @property(cc.Node)\n  onSpeakersChangeBtn: cc.Node = null\n\n  @property(cc.Node)\n  returnBtn: cc.Node = null\n\n  @property(cc.Label)\n  logLabel: cc.Label = null\n \n  @property(cc.Label)\n  onStatusLabel: cc.Label = null\n\n  @property(cc.Label)\n  onMembersChangeLabel: cc.Label = null\n\n  @property(cc.Label)\n  onSpeakersChangeLabel: cc.Label = null\n\n  @property(cc.Label)\n  tip: cc.Label = null\n\n  start() {\n    this.tip.node.active = false\n    let audio = qg.createInnerAudioContext()\n    audio.src = 'https://sharefs.ali.kugou.com/202107161456/788024988871910afd76ee3ac772296b/KGTX/CLTX001/9c29ccf742c1a8f8a8171dd3305b428b.mp3'\n    audio.loop = true\n    console.log('audtio', audio)\n    this.playBGMToggle.node.on('toggle', (toggle)=> {\n      console.log('playBGMToggle', toggle.isChecked)\n      if(toggle.isChecked) {\n        window['audio'] = audio\n        audio.play()\n        audio.volume = 0.05\n        console.log('volume', audio.volume)\n      } else {\n        audio.stop()\n      }\n    })\n\n    this.joinBtn.on(cc.Node.EventType.TOUCH_START,async () => {\n      let ip = this.ipInput.string || ''\n      let groupId = this.groupIdInput.string || ''\n      let microphone = this.microphoneToggle.isChecked\n      let speakerPhone = this.speakerphoneToggle.isChecked\n      let timeStamp = new Date().getTime()\n      console.log('microphone', microphone)\n      console.log('speakerPhone', speakerPhone)\n      let nonceStr = Math.random()+''\n      let signature\n      let url = `http://${ip}:3000/getSignature`\n      console.log('服务端接口', url)\n      // 自己通过接口请求获取签名\n      try {\n        signature = await this.sendPostRequest(url, {\n          token: window['TOKEN'], // 获取通过 qg.login 获取的并全局存储的大厅 token\n          channelName: groupId,\n          pkg: 'com.oppo.littleGameDemo',\n          timeStamp,\n          nonceStr\n        })\n      } catch (error) {\n        this.log(error+': 请检查服务器接口')\n        return\n      }\n      console.log('signature', signature)\n      console.log('joinVoIPChat params: ', {\n        signature, \n        nonceStr,\n        timeStamp,\n        groupId,\n        muteConfig: {\n          muteMicrophone: microphone,\n          muteSpeakerPhone: speakerPhone\n        }\n      })\n      qg.joinVoIPChat({\n        signature, \n        nonceStr,\n        timeStamp,\n        groupId,\n        muteConfig: {\n          muteMicrophone: microphone,\n          muteSpeakerPhone: speakerPhone\n        },\n        success: (res) => {\n          this.tip.node.active = true\n          this.tip.getComponent(cc.Label).string = `已加入房间，openIdList 为： ${res['openIdList']}`\n          this.log(`success: ${JSON.stringify(res)}`)\n        },\n        fail: (res) => {\n          console.log(res)\n          this.log(`fail: ${JSON.stringify(res)}`)\n        }\n      })\n    })\n\n    this.exitBtn.on(cc.Node.EventType.TOUCH_START, () => {\n      qg.exitVoIPChat({\n        success: (res) => {\n          this.tip.getComponent(cc.Label).string = `已离开房间`\n          this.log(`success: ${JSON.stringify(res)}`)\n        },\n        fail: (res) => {\n          this.log(`fail: ${JSON.stringify(res)}`)\n        }\n      })\n    })\n    this.updateBtn.on(cc.Node.EventType.TOUCH_START, () => {\n      let microphone = this.microphoneToggle.isChecked\n      let speakerPhone = this.speakerphoneToggle.isChecked\n      console.log('microphone', microphone)\n      console.log('speakerPhone', speakerPhone)\n      qg.updateVoIPChatMuteConfig({\n        muteConfig: {\n          muteMicrophone: microphone,\n          muteSpeakerPhone: speakerPhone\n        },\n        success: (res) => {\n          this.log(`success: ${JSON.stringify(res)}`)\n        },\n        fail: (res) => {\n          this.log(`fail: ${JSON.stringify(res)}`)\n        }\n      })\n    })\n    this.onMembersChangeBtn.on(cc.Node.EventType.TOUCH_START, () => {\n      let inputCb = (res) => {\n        this.onMembersChangeLabel.getComponent(cc.Label).string = JSON.stringify(res)\n      }\n      if(cc.find(\"Background/Label\", this.onMembersChangeBtn).getComponent(cc.Label).string == '监听房间成员变化') {\n        qg.onVoIPChatMembersChanged(inputCb)\n        cc.find(\"Background/Label\", this.onMembersChangeBtn).getComponent(cc.Label).string = '取消监听房间成员变化'\n      } else {\n        qg.offVoIPChatMembersChanged()\n        this.onMembersChangeLabel.getComponent(cc.Label).string = \"取消监听房间成员变化\"\n        cc.find(\"Background/Label\", this.onMembersChangeBtn).getComponent(cc.Label).string = '监听房间成员变化'\n      }\n    })\n    this.onSpeakersChangeBtn.on(cc.Node.EventType.TOUCH_START, () => {\n      let completeCb = (res) => {\n        this.onSpeakersChangeLabel.getComponent(cc.Label).string = JSON.stringify(res)\n      }\n      if(cc.find(\"Background/Label\", this.onSpeakersChangeBtn).getComponent(cc.Label).string == '监听房间成员通话状态变化') {\n        qg.onVoIPChatSpeakersChanged(completeCb)\n        cc.find(\"Background/Label\", this.onSpeakersChangeBtn).getComponent(cc.Label).string = '取消监听房间成员通话状态变化'\n      } else {\n        qg.offVoIPChatSpeakersChanged()\n        this.onSpeakersChangeLabel.getComponent(cc.Label).string = \"取消监听房间成员通话状态变化\"\n        cc.find(\"Background/Label\", this.onSpeakersChangeBtn).getComponent(cc.Label).string = '监听房间成员通话状态变化'\n      }\n    })\n    this.onStatusBtn.on(cc.Node.EventType.TOUCH_START, () => {\n      let confirmCb = (res) => {\n        this.onStatusLabel.getComponent(cc.Label).string = JSON.stringify(res)\n      }\n      if(cc.find(\"Background/Label\", this.onStatusBtn).getComponent(cc.Label).string == '监听房间状态变化') {\n        qg.onVoIPChatStatusChanged(confirmCb)\n        cc.find(\"Background/Label\", this.onStatusBtn).getComponent(cc.Label).string = '取消监听房间状态变化'\n      } else {\n        qg.offVoIPChatStatusChanged()\n        this.onStatusLabel.getComponent(cc.Label).string = \"取消监听房间状态变化\"\n        cc.find(\"Background/Label\", this.onStatusBtn).getComponent(cc.Label).string = '监听房间状态变化'\n      }\n    })\n\n    this.returnBtn.on(cc.Node.EventType.TOUCH_START, () => {\n      cc.director.loadScene('main')\n    })\n  }\n  \n  // 回调信息展示\n  log(msg) {\n    console.log(msg)\n    this.logLabel.getComponent(cc.Label).string = msg\n  }\n\n  sendPostRequest(url, params) {\n    return new Promise((resolve, reject) => {\n      let xhr = new XMLHttpRequest();\n      xhr.onreadystatechange = function () {\n          if (xhr.readyState == 4) {\n            let response = xhr.responseText;\n            if(xhr.status >= 200 && xhr.status <= 400) {\n              console.log(\"连接成功\");\n              console.log(response);\n              resolve(response)\n            } else {\n              console.log(\"连接失败\")\n              reject(`${xhr.status} ${xhr.statusText}`)\n            }\n          }\n      };\n      xhr.onerror = function() {\n        reject(new Error(xhr.statusText));\n      }\n      xhr.open(\"POST\", url);\n      xhr.setRequestHeader(\"Content-type\", \"application/json\");\n      xhr.send(JSON.stringify(params));\n    })\n  }\n}\n"]}