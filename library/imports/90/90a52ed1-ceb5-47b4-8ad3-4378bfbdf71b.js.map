{"version":3,"sources":["../../../../../assets/Script/media/assets/Script/media/RecorderManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../../assets/Script/media","sourcesContent":["/**\n * @desc: { 图片 } \n * @author: zhengyiqiu \n * @Create Date: 2020-06-29 17:43:49 \n * @Last Modified by: zhengyiqiu\n * @Last Modified time: 2020-06-30 17:59:41\n */\n\nconst { ccclass, property } = cc._decorator\n\nlet record\nlet options = {\n  duration: 10000,\n  sampleRate: 44100,\n  numberOfChannels: 1,\n  encodeBitRate: 192000,\n  format: 'aac',\n  frameSize: 50\n}\nlet url\nlet audio\n@ccclass\nexport default class RecorderManager extends cc.Component {\n  @property(cc.Label)\n  logLabel: cc.Label = null\n\n  @property(cc.Node)\n  startBtn: cc.Node = null\n\n  @property(cc.Node)\n  pauseBtn: cc.Node = null\n\n  @property(cc.Node)\n  resumeBtn: cc.Node = null\n\n  @property(cc.Node)\n  stopBtn: cc.Node = null\n\n  @property(cc.Node)\n  playBtn: cc.Node = null\n  \n  @property(cc.Node)\n  returnBtn: cc.Node = null\n  \n  start() {\n    record = qg.getRecorderManager()\n    audio = qg.createInnerAudioContext()\n    this.setBtnStatus(this.playBtn, false)\n    this.setBtnStatus(this.pauseBtn, false)\n    this.setBtnStatus(this.resumeBtn, false)\n    this.setBtnStatus(this.stopBtn, false)\n\n    this.returnBtn.on(cc.Node.EventType.TOUCH_START, () => {\n      cc.director.loadScene('media')\n    })\n  }\n\n  clickStart() {\n    record.start(options)\n    this.log('开始录音')\n    this.setBtnStatus(this.startBtn, false)\n    this.setBtnStatus(this.pauseBtn, true)\n    this.setBtnStatus(this.resumeBtn, true)\n    this.setBtnStatus(this.stopBtn, true)\n    record.onStop((res) => {\n      url = res.tempFilePath\n      this.log(`录音文件：${res.tempFilePath}`)\n      this.setBtnStatus(this.startBtn, true)\n      this.setBtnStatus(this.playBtn, true)\n      this.setBtnStatus(this.pauseBtn, false)\n      this.setBtnStatus(this.resumeBtn, false)\n      this.setBtnStatus(this.stopBtn, false)\n    })\n  }\n\n  clickPause(){\n    record.pause()\n    this.log('暂停录音')\n    this.setBtnStatus(this.pauseBtn, false)\n    this.setBtnStatus(this.resumeBtn, true)\n  }\n\n  clickResume() {\n    record.resume()      \n    this.log('继续录音')\n    this.setBtnStatus(this.pauseBtn, true)\n    this.setBtnStatus(this.resumeBtn, false)\n  }\n\n  clickStop() {\n    this.log('停止录音')\n    this.setBtnStatus(this.pauseBtn, false)\n    this.setBtnStatus(this.resumeBtn, false)\n    this.setBtnStatus(this.playBtn, true)\n    record.stop()    \n  }\n\n  clickPlay() {\n    if(url) {\n      this.setBtnStatus(this.playBtn, false)\n      audio.src = url\n      this.log(`播放音乐：${url}`)\n      audio.play()\n      audio.onEnded(() => {\n        this.setBtnStatus(this.playBtn, true) \n      })\n    }\n  }\n\n  log(msg) {\n    console.log(msg)\n    this.logLabel.getComponent(cc.Label).string = msg\n  }\n  setBtnStatus(node, status) {\n    node.getComponent(cc.Button).interactable = status\n  }\n}\n"]}